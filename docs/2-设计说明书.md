# 南锣鼓巷旅游导览系统 - 设计说明书

## 一、系统架构

### 1.1 整体架构图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              用户访问层                                      │
│                                                                             │
│     ┌─────────────────┐              ┌─────────────────┐                    │
│     │   Web浏览器      │              │   微信客户端     │                    │
│     │  Chrome/Edge    │              │   小程序         │                    │
│     └────────┬────────┘              └────────┬────────┘                    │
│              │                                │                             │
└──────────────┼────────────────────────────────┼─────────────────────────────┘
               │          HTTP/HTTPS            │
┌──────────────┼────────────────────────────────┼─────────────────────────────┐
│              │         前端应用层             │                             │
│              ▼                                ▼                             │
│     ┌─────────────────┐              ┌─────────────────┐                    │
│     │   Vue3 SPA      │              │   小程序页面     │                    │
│     │   :3000端口     │              │   WXML/WXSS     │                    │
│     │                 │              │                 │                    │
│     │ · 首页          │              │ · 首页          │                    │
│     │ · 景点列表      │              │ · 景点列表      │                    │
│     │ · 景点详情      │              │ · 景点详情      │                    │
│     │ · 推荐路线      │              │ · 推荐路线      │                    │
│     └────────┬────────┘              └────────┬────────┘                    │
│              │                                │                             │
└──────────────┼────────────────────────────────┼─────────────────────────────┘
               │          API请求               │
               └───────────────┬────────────────┘
                               ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            后端服务层                                        │
│                                                                             │
│     ┌─────────────────────────────────────────────────────────────────┐     │
│     │                    Django REST Framework                        │     │
│     │                        :8000端口                                │     │
│     ├─────────────────────────────────────────────────────────────────┤     │
│     │                                                                 │     │
│     │   /api/hutong/     胡同信息接口                                 │     │
│     │   /api/pois/       景点列表/详情接口                            │     │
│     │   /api/routes/     路线列表/详情接口                            │     │
│     │   /api/search/     搜索接口                                     │     │
│     │                                                                 │     │
│     └─────────────────────────────────────────────────────────────────┘     │
│                               │                                             │
└───────────────────────────────┼─────────────────────────────────────────────┘
                                │ ORM
┌───────────────────────────────┼─────────────────────────────────────────────┐
│                               ▼                                             │
│     ┌─────────────────────────────────────────────────────────────────┐     │
│     │                      SQLite 数据库                              │     │
│     │                      db.sqlite3                                 │     │
│     └─────────────────────────────────────────────────────────────────┘     │
│                            数据存储层                                        │
└─────────────────────────────────────────────────────────────────────────────┘
```


### 1.2 模块划分

| 模块 | 职责 | 技术实现 |
|------|------|----------|
| 前端展示 | 用户界面渲染、交互处理 | Vue3 + Element Plus |
| 小程序端 | 移动端用户界面 | 微信原生开发 |
| API服务 | 数据接口、业务逻辑 | Django REST Framework |
| 数据管理 | 数据存储、后台维护 | Django Admin + SQLite |

---

## 二、数据库设计

### 2.1 ER图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              ER 实体关系图                                   │
└─────────────────────────────────────────────────────────────────────────────┘

    ┌───────────────────┐                         ┌───────────────────┐
    │      Hutong       │                         │       POI         │
    │      胡同         │                         │      景点         │
    ├───────────────────┤                         ├───────────────────┤
    │ PK id             │                         │ PK id             │
    │    name           │                         │    name           │
    │    description    │                         │    type           │
    │    location       │                         │    description    │
    │    length         │                         │    brief          │
    │    history        │                         │    location       │
    │    features       │                         │    images         │
    │    images         │                         │    opening_hours  │
    └───────────────────┘                         │    tips           │
                                                  │    order          │
                                                  └─────────┬─────────┘
                                                            │
                                                            │ 1
                                                            │
                                                            │ N
    ┌───────────────────┐         N           ┌─────────────┴─────────┐
    │      Route        │◄────────────────────│      RoutePOI         │
    │      路线         │                     │    路线景点关联        │
    ├───────────────────┤         1           ├───────────────────────┤
    │ PK id             │                     │ PK id                 │
    │    name           │                     │ FK route_id           │
    │    description    │                     │ FK poi_id             │
    │    duration       │                     │    order              │
    │    distance       │                     └───────────────────────┘
    └───────────────────┘

    关系说明：
    · Route 与 POI 是多对多关系，通过 RoutePOI 中间表关联
    · RoutePOI.order 字段记录景点在路线中的顺序
```

### 2.2 数据表结构

**Hutong 胡同表**
| 字段 | 类型 | 说明 |
|------|------|------|
| id | INTEGER | 主键，自增 |
| name | VARCHAR(100) | 胡同名称 |
| description | TEXT | 详细介绍 |
| location | VARCHAR(200) | 地理位置 |
| length | VARCHAR(50) | 全长 |
| history | TEXT | 历史沿革 |
| features | TEXT | 特色简介 |
| images | JSON | 图片列表 |

**POI 景点表**
| 字段 | 类型 | 说明 |
|------|------|------|
| id | INTEGER | 主键，自增 |
| name | VARCHAR(100) | 景点名称 |
| type | VARCHAR(20) | 类型(celebrity/historic/food/shop/culture) |
| description | TEXT | 详细介绍(≥100字) |
| brief | VARCHAR(200) | 简短描述 |
| location | VARCHAR(200) | 具体位置 |
| images | JSON | 图片列表 |
| opening_hours | VARCHAR(100) | 开放时间 |
| tips | TEXT | 游览提示 |
| order | INTEGER | 排序序号 |

**Route 路线表**
| 字段 | 类型 | 说明 |
|------|------|------|
| id | INTEGER | 主键，自增 |
| name | VARCHAR(100) | 路线名称 |
| description | TEXT | 路线介绍 |
| duration | VARCHAR(50) | 预计时长 |
| distance | VARCHAR(50) | 总距离 |

**RoutePOI 路线景点关联表**
| 字段 | 类型 | 说明 |
|------|------|------|
| id | INTEGER | 主键，自增 |
| route_id | INTEGER | 外键，关联Route |
| poi_id | INTEGER | 外键，关联POI |
| order | INTEGER | 景点在路线中的顺序 |


---

## 三、核心界面原型

### 3.1 Web端界面

**首页**
```
┌─────────────────────────────────────────────────────────────────────────────┐
│  🏮 南锣鼓巷旅游导览                    [首页]  [景点]  [路线]              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ╔═══════════════════════════════════════════════════════════════════════╗  │
│  ║                         🏮 南锣鼓巷                                   ║  │
│  ║                                                                       ║  │
│  ║     南锣鼓巷是北京最古老的街区之一，位于北京市东城区，始建于元代，    ║  │
│  ║     距今已有740余年历史。全长787米，东西两侧各有8条胡同整齐排列...    ║  │
│  ║                                                                       ║  │
│  ║     📍 北京市东城区          📏 全长787米                             ║  │
│  ╚═══════════════════════════════════════════════════════════════════════╝  │
│                                                                             │
│         ┌─────────────────────┐         ┌─────────────────────┐             │
│         │     🏠 景点列表      │         │     🗺️ 推荐路线      │             │
│         │     探索10+景点     │         │     2条主题路线     │             │
│         └─────────────────────┘         └─────────────────────┘             │
│                                                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                          © 南锣鼓巷旅游导览系统                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

**景点列表页**
```
┌─────────────────────────────────────────────────────────────────────────────┐
│  🏮 南锣鼓巷旅游导览                    [首页]  [景点]  [路线]              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│                              🏠 景点列表                                    │
│                                                                             │
│                    ┌─────────────────────────────────┐                      │
│                    │  🔍 搜索景点...                 │                      │
│                    └─────────────────────────────────┘                      │
│                                                                             │
│  ┌─────────────────────┐  ┌─────────────────────┐  ┌─────────────────────┐  │
│  │  ┌───────────────┐  │  │  ┌───────────────┐  │  │  ┌───────────────┐  │  │
│  │  │    [图片]     │  │  │  │    [图片]     │  │  │  │    [图片]     │  │  │
│  │  └───────────────┘  │  │  └───────────────┘  │  │  └───────────────┘  │  │
│  │  茅盾故居           │  │  齐白石旧居纪念馆   │  │  僧格林沁王府       │  │
│  │  [名人故居]         │  │  [名人故居]         │  │  [历史建筑]         │  │
│  │  中国现代著名作家   │  │  国画大师齐白石曾   │  │  清代蒙古亲王僧格   │  │
│  │  茅盾晚年居住地     │  │  在此居住创作       │  │  林沁的府邸         │  │
│  └─────────────────────┘  └─────────────────────┘  └─────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

**景点详情页**
```
┌─────────────────────────────────────────────────────────────────────────────┐
│  ← 返回列表                                                                 │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ╔═══════════════════════════════════════════════════════════════════════╗  │
│  ║                          [图片轮播区域]                               ║  │
│  ║                           ●  ○  ○  ○                                  ║  │
│  ╚═══════════════════════════════════════════════════════════════════════╝  │
│                                                                             │
│    茅盾故居                                              [名人故居]          │
│    📍 后圆恩寺胡同13号                                                      │
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │  ⏰ 开放时间：9:00-16:30                                              │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │  💡 游览提示：周一闭馆，免费参观需提前预约                            │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │  📖 详细介绍                                                          │  │
│  │  茅盾故居位于后圆恩寺胡同13号，是中国现代著名作家茅盾晚年居住和工作   │  │
│  │  的地方。这是一座典型的北京四合院，占地面积约800平方米...             │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 小程序界面

```
┌───────────────────┐    ┌───────────────────┐    ┌───────────────────┐
│      首页         │    │     景点列表      │    │     推荐路线      │
├───────────────────┤    ├───────────────────┤    ├───────────────────┤
│                   │    │                   │    │                   │
│  ╔═════════════╗  │    │ ┌───────────────┐ │    │   🗺️ 推荐路线     │
│  ║ 🏮南锣鼓巷  ║  │    │ │🔍 搜索景点... │ │    │                   │
│  ║             ║  │    │ └───────────────┘ │    │ ╔═══════════════╗ │
│  ║ 北京最古老  ║  │    │                   │    │ ║ 经典文化游    ║ │
│  ║ 的街区之一  ║  │    │ ┌───────────────┐ │    │ ║ ⏱️2h 📏1.5km  ║ │
│  ║             ║  │    │ │[图] 茅盾故居  │ │    │ ║ [展开详情 ▼] ║ │
│  ║ 📍东城区    ║  │    │ │    [名人故居] │ │    │ ╚═══════════════╝ │
│  ║ 📏787米     ║  │    │ └───────────────┘ │    │                   │
│  ╚═════════════╝  │    │                   │    │ ╔═══════════════╗ │
│                   │    │ ┌───────────────┐ │    │ ║ 休闲美食游    ║ │
│ ┌─────┐ ┌─────┐   │    │ │[图] 齐白石    │ │    │ ║ ⏱️1.5h 📏1km ║ │
│ │景点 │ │路线 │   │    │ │    [名人故居] │ │    │ ║ [展开详情 ▼] ║ │
│ └─────┘ └─────┘   │    │ └───────────────┘ │    │ ╚═══════════════╝ │
│                   │    │                   │    │                   │
├───────────────────┤    ├───────────────────┤    ├───────────────────┤
│[首页][景点][路线] │    │[首页][景点][路线] │    │[首页][景点][路线] │
└───────────────────┘    └───────────────────┘    └───────────────────┘
```

### 3.3 API接口设计

| 接口 | 方法 | 说明 | 响应格式 |
|------|------|------|----------|
| /api/hutong/ | GET | 获取胡同信息 | {name, description, location, ...} |
| /api/pois/ | GET | 获取景点列表 | {count, results: [...]} |
| /api/pois/{id}/ | GET | 获取景点详情 | {id, name, description, images, ...} |
| /api/routes/ | GET | 获取路线列表 | {count, results: [...]} |
| /api/routes/{id}/ | GET | 获取路线详情 | {id, name, pois: [...]} |
| /api/search/?q= | GET | 搜索景点 | {count, results: [...]} |
